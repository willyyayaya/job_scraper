# 104人力銀行職缺爬蟲 (AI增強版)

這是一個功能強大的104人力銀行職缺爬蟲工具，使用Python和Playwright實現，並整合了OpenAI API來增強數據分析和處理能力。

## 功能特色

- **自動爬取**：自動從104人力銀行搜索並爬取職缺資訊
- **AI增強搜索**：使用OpenAI API優化搜索關鍵詞，獲得更精準的搜索結果
- **智能數據提取**：嘗試使用AI從複雜頁面結構中提取職缺資訊
- **深度分析**：分析職缺描述，提取關鍵技能和見解
- **生成報告**：生成詳細的職缺分析報告，包含市場趨勢和推薦機會
- **離線模式**：無需OpenAI API也能正常運行基本爬蟲功能

## 安裝依賴

```bash
# 安裝Python依賴
pip install pandas openai playwright

# 安裝Playwright瀏覽器
python -m playwright install chromium
```

## 使用方法

### 1. 設置OpenAI API密鑰

有兩種方式可以設置API密鑰：

- **環境變數**（推薦）：
  ```bash
  # Windows
  set OPENAI_API_KEY=你的API密鑰
  
  # Mac/Linux
  export OPENAI_API_KEY=你的API密鑰
  ```

- **運行時輸入**：如果未設置環境變數，程式會在運行時提示輸入API密鑰

### 2. 運行爬蟲

```bash
python job_scraper_final.py
```

### 3. 使用流程

1. 輸入想要搜索的職缺名稱（例如：前端工程師、AI工程師等）
2. 指定要爬取的頁數（建議1-5頁）
3. 程式會自動：
   - 使用AI優化搜索關鍵詞（如有啟用AI功能）
   - 爬取搜索結果頁面
   - 提取職缺資訊
   - 分析職缺數據
   - 保存結果到Excel文件
4. 最後可選擇是否生成詳細的職缺分析報告

## AI增強功能

本程式整合了多種AI增強功能：

1. **搜索關鍵詞優化**：根據用戶輸入生成更有效的搜索關鍵詞
2. **HTML解析輔助**：協助從複雜的頁面結構中提取資訊
3. **職缺分析**：
   - 自動提取關鍵技能要求
   - 評估薪資合理性
   - 識別優質職缺機會
   - 總結職缺市場趨勢
4. **報告生成**：生成結構化的HTML報告，包含數據分析和求職建議

## 示例報告內容

生成的職缺分析報告通常包含以下部分：

- **執行摘要**：市場概況與總體發現
- **薪資分析**：薪資水平和分布
- **技能需求**：最常見的技能要求和資格
- **地區分布**：職缺在不同地區的分布情況
- **推薦機會**：特別值得關注的優質職缺
- **求職建議**：如何提高應聘成功率

## 離線模式

如果無法使用OpenAI API或不想使用AI功能，程式會自動切換到離線模式，依然可以執行基本的爬蟲功能。

## 注意事項

- 請合理使用本工具，避免頻繁爬取對目標網站造成壓力
- OpenAI API使用會產生費用，請注意控制使用量
- 本工具僅供學習和研究使用，請遵守相關法律法規

## 更新日誌

- v2.0: 添加OpenAI集成，增強分析能力
- v1.0: 基本爬蟲功能實現

## 三種版本的比較

| 特性 | Playwright 版本 | Skyvern AI 版本 | Playwright + LangChain 版本 |
|------|--------------|-------------------|---------------------------|
| 代碼複雜度 | 較高 | 較低 | 中等 |
| 需要選擇器維護 | 是 | 否 | 部分需要 |
| 適應網頁變化能力 | 中等 | 高 | 高 |
| API 依賴 | 無 | 開源，可本地部署 | 需要 OpenAI API |
| 費用 | 免費 | 免費開源 / 付費雲服務 | 需支付 API 使用費 |
| 易於擴展 | 中等 | 高 | 高 |
| CAPTCHA 支持 | 有限 | 支持 | 有限 |
| 開發控制程度 | 高 | 低 | 中等 |
| 適合場景 | 穩定爬取、預算有限 | 複雜網站、少量爬取 | 結構變化網站、需精確控制 |

## 輸出格式

爬蟲產生的 Excel 檔案包含以下欄位：

- 職缺名稱
- 公司名稱
- 工作地點
- 經驗要求
- 學歷要求
- 薪資待遇
- 職缺描述
- 職缺標籤
- 連結

## 更多資訊

- Skyvern 官方網站: https://www.skyvern.com/
- Skyvern GitHub: https://github.com/skyvern-ai/skyvern (檢查最新的安裝和使用說明)
- LangChain 文檔: https://python.langchain.com/ 