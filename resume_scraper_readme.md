# 104人力銀行求職者資料爬蟲

這是一個使用企業會員帳號從104人力銀行爬取求職者資料的工具。

## 功能特點

- 使用企業會員帳號登入104人力銀行
- 根據關鍵詞搜尋求職者
- 爬取求職者基本資訊（姓名、職稱、工作經驗、學歷等）
- 下載求職者照片
- 獲取詳細履歷資料
- 支援分頁爬取
- 自動儲存爬取進度
- 結果匯出為Excel和JSON格式

## 環境需求

- Python 3.7+
- 以下Python套件：
  - playwright
  - pandas
  - aiofiles
  - asyncio

## 安裝步驟

1. 安裝必要的Python套件：

```bash
pip install playwright pandas aiofiles
```

2. 安裝Playwright瀏覽器：

```bash
python -m playwright install chromium
```

## 使用方法

1. 執行程式：

```bash
python company_resume_scraper.py
```

2. 依照提示輸入以下資訊：
   - 104企業會員帳號
   - 104企業會員密碼
   - 搜索關鍵詞（可選）
   - 爬取頁數
   - 是否獲取詳細履歷
   - 是否下載照片
   - 是否隱藏瀏覽器

3. 程式將自動執行以下流程：
   - 登入104企業會員系統
   - 搜索符合條件的求職者
   - 爬取求職者資料
   - 下載照片（如有設定）
   - 獲取詳細履歷（如有設定）
   - 儲存結果

## 輸出結果

爬蟲會在當前目錄下創建一個以時間戳命名的資料夾 `resume_data_YYYYMMDD_HHMMSS`，包含：

- `履歷資料_第X頁.xlsx` - 每頁的履歷資料Excel檔
- `履歷資料_第X頁.json` - 每頁的履歷資料JSON檔
- `104履歷_關鍵詞_時間戳.xlsx` - 全部履歷資料Excel檔
- `104履歷_關鍵詞_時間戳.json` - 全部履歷資料JSON檔
- `photos/` - 求職者照片資料夾（如有設定下載照片）
- `search_result.html` - 搜索結果頁面HTML

## 注意事項

1. **法律與道德考量**：
   - 使用本工具需遵守104人力銀行的使用條款
   - 需遵守《個人資料保護法》，未經許可不得為非法目的收集或使用個人資料
   - 僅供學習研究使用，請勿用於商業或非法用途

2. **使用建議**：
   - 控制爬取速度和頻率，避免對網站造成負擔
   - 如遇到驗證碼，程式會提示手動處理
   - 避免短時間內大量爬取，可能導致帳號被暫時鎖定

3. **企業會員身份**：
   - 使用本工具需有合法的104企業會員身份
   - 不當使用可能導致會員權限被104人力銀行限制或停用

## 常見問題

1. **登入失敗**：
   - 檢查帳號密碼是否正確
   - 檢查是否有啟用二次驗證
   - 檢查帳號是否被鎖定

2. **爬取失敗**：
   - 檢查網路連接
   - 檢查是否因爬取頻率過高被限制
   - 查看日誌文件 `resume_scraper.log` 獲取詳細錯誤信息

3. **驗證碼處理**：
   - 當出現驗證碼時，程式會停止並提示手動處理
   - 在瀏覽器中完成驗證後，按Enter繼續程式執行

## 進階配置

如需修改爬蟲的高級設定，可直接編輯程式碼中的 `ResumeScraperConfig` 類：

- `delay_range` - 請求延遲範圍（秒）
- `headless` - 是否隱藏瀏覽器
- `download_photos` - 是否下載照片
- `max_pages` - 最大爬取頁數

## 免責聲明

本工具僅供學習研究使用，使用者須自行承擔使用本工具的一切法律責任。開發者不對任何人因使用本工具而可能導致的任何直接或間接損失負責。 